/*! lib - v1.0.0 - 2024-09-15 */
var UploadButton,indexOf=[].indexOf,Modal=class{constructor(){this.register={prototype:{map:{},storage:{},add:function(e){var t;if(!(e&&e instanceof Object))throw"Missing arguments";t=Symbol(e.name),this.map[e.name]=t,this.storage[t]=e},has:function(e){if(e)return!!(e=this.map[e])&&!!this.storage[e];throw"Missing name"},fetch:function(e){if(e)return this.has(e)?this.storage[this.map[e]]:null;throw"Missing name"},remove:function(e){var t;if(!e)throw"Missing name";if(this.has(e))return t=this.map[e],delete this.storage[t],delete this.map[e],!0},list:function(){for(var e,t,r={},i=Object.entries(this.map),a=0,s=i.length;a<s;a++)[e,t]=i[a],r[e]=this.storage[t];return 0<Object.keys(r).length?r:null}},windows:{counter:0,storage:{},add:function(e){var t;if(e&&e instanceof Object)return t=Symbol(e.name),this.storage[t]=e,this.counter+=1,t;throw"Wrong parameter"},remove:function(e){if(!(e&&e instanceof Symbol))throw"Missing Symbol";if(this.storage[e])return--this.counter,delete this.storage[e]},has:function(e){if(e&&e instanceof Symbol)return!!this.storage[e];throw"Missing Symbol"},fetch:function(e){return this.has(e)?this.storage[e]:null},list:function(){return 0<this.counter?this.storage:null}}}}add(e){var t,r,i,a;try{if(!e||!e instanceof Object)throw"Parameter corrupt";if(0<=indexOf.call(e,!1)||0<=indexOf.call(e,!1)||0<=indexOf.call(e,!1))throw"Missing parameter";if(!e.name||!e.html)throw"The 'html'and the 'template' parameters should be defined";({name:i,html:r,handler:t}=e),(a=document.createElement("template")).innerHTML=r,this.register.prototype.add({name:i,template:a,onshow:t.onshow,onhide:t.onhide,clean:t.clean})}catch(e){[]instanceof Error}}prepare(e){var t,r,i;try{if(!e)throw"Missing name";if(this.register.prototype.has(e))return r=new WeakMap,i={},t={},r.set(t,this.register.prototype.fetch(e)),Object.defineProperty(i,"name",{value:r.get(t).name,writable:!1,configurable:!1}),Object.defineProperty(i,"node",{value:r.get(t).template.content.firstElementChild,writable:!1,configurable:!1}),Object.defineProperty(i,"sym",{value:this.register.windows.add(i),writable:!1,configurable:!1}),Object.defineProperty(i,"register",{value:this.register.windows,writable:!1,configurable:!1}),Object.defineProperty(i,"preserve",{set:function(e){return this.isPreserved=!!e&&"true"}}),Object.defineProperty(i,"onshow",{value:r.get(t).onshow,writable:!1,configurable:!1}),Object.defineProperty(i,"onhide",{value:r.get(t).onhide,writable:!1,configurable:!1}),Object.defineProperty(i,"clean",{value:r.get(t).clean,writable:!1,configurable:!1}),Object.defineProperty(i,"show",{value:function(e){if(!e||!e instanceof Element)throw"Missing container";return this.onshow&&this.onshow(),e.appendChild(this.node),(this.onDisplay=this).container=e},writable:!1,configurable:!1}),Object.defineProperty(i,"hide",{value:function(){return this.onDisplay=!1,this.isPreserved||(this.register.remove(this.sym),this.clean&&this.clean()),this.onhide&&this.onhide(),this.container.removeChild(this.node)},writable:!1,configurable:!1}),r.delete(t),i;throw"No such modal"}catch(e){[]instanceof Error}}find(e){try{if(!e)throw"Missing Symbol";if(!e instanceof Symbol)throw"Wrong parameter";return this.register.windows.fetch(e)}catch(e){[]instanceof Error}}};class requestFunctions{constructor(){}validateArgs(){try{if(!this.args||!this.args.path||!this.args.method)throw"Missing property,\n either path or method, others are optional";if("GET"!==this.args.method&&"POST"!==this.args.method&&"PUT"!==this.args.method)throw"Unsupported method";if(this.args.headers&&"auto"!==this.args.headers){if(!Array.isArray(this.args.headers))throw"Wrong property instance. The 'headers' property, should be an array instance";if(0===this.args.headers.length)throw"If there is no headers in request, the 'headers' property should be defined as 'auto' ";let r;if(this.args.headers.forEach(function(e,t){r=!(!Array.isArray(e)||2!==e.length||"string"!=typeof e[0]||"string"!=typeof e[1])&&!1!==r}),!r)throw"Corrupted headers structure, all parameters should be an instance of an array, have two indexes, and they should be strings"}if(this.args.data){if(!Array.isArray(this.args.data))throw"Wrong property instance. The 'data' property, should be an array instance";if(0===this.args.data.length)throw"If there is no parameters in request data, the 'data' property should be defined as null";let r;if(this.args.data.forEach(function(e,t){r=e instanceof Object&&"name"in e&&"value"in e&&"string"==typeof e.name&&!1!==r}),!r)throw"Corrupted data structure, all parameters should be an instance of an object, have name and value properties, name schoud be a string"}return!0}catch(e){throw e instanceof Error?"Syntax error":`Provided arguments are invalid
\r`+e}}prepareRequest(){try{if(this.path=this.args.path,this.method=this.args.method,this.headers="auto"===this.args.headers?null:this.args.headers,this.args.data)if("GET"===this.args.method){let t;t="?time="+encodeURIComponent((new Date).toString()),this.args.data.forEach(function(e){t+=`&${e.name}=`+encodeURIComponent(e.value)}),this.path=this.path+t}else if("POST"===this.args.method){let t=new FormData;t.append("time",(new Date).toString()),this.args.data.forEach(function(e){t.append(e.name,e.value)}),this.data=t}}catch(e){throw e instanceof Error?"Syntax error":"While preparing request\n"+e}}}class XHRRequest extends requestFunctions{constructor(e){return super(),this.args=e,this.init()}init(){try{return this.validateArgs(),this.prepareRequest(),this.call()}catch(e){return!1}}call(){return new Promise((t,r)=>{let i=new XMLHttpRequest;this.args.progress&&i.upload.addEventListener("progress",this.args.progress),i.addEventListener("error",e=>{this.args.error&&this.args.error(e),r(e)}),i.addEventListener("abort",e=>{this.args.abort&&this.args.abort(e),r(e)}),i.addEventListener("load",e=>{this.args.load&&this.args.load(e),t(JSON.parse(e.target.response))}),i.open(this.method,this.path,!0),this.headers&&this.headers.forEach(function(e){i.setRequestHeader(e[0],e[1])}),i.send(this.data||null)})}}UploadButton=class{constructor(){return this.prepareNode(),this.export}prepareNode(){var r,i,e=document.createElement("template");return e.innerHTML=`<div role="button">
  <button ref="btn">Browse</button>
  <input  ref="inpt" type="file" hidden />
</div>`,e=e.content.firstElementChild,i=this.setupNode.bind(this),r=(e,t)=>{if("resolve"===e&&(this.success=t),"reject"===e&&(this.failure=t),"fileReadMethod"===e&&(this.fileReadMethod=t),"readerEncoding"===e)return this.readerEncoding=t},Object.defineProperty(this,"export",{value:{wrapper:e,button:e.querySelector("[ref=btn]"),input:e.querySelector("[ref=inpt]"),files:[]}}),Object.defineProperty(this.export,"wasInput",{get(){return new Promise((e,t)=>{i(),r("resolve",e),r("reject",t)})}}),Object.defineProperty(this.export,"returnFormat",{set(t){var e=["readAsArrayBuffer","readAsDataURL","readAsText"].some(function(e){return e===t});r("fileReadMethod",e?t:"readAsDataURL")}}),Object.defineProperty(this.export,"encodingFormat",{set(t){var e=["US-ASCII","ISO_8859-1:1987","ISO_8859-2:1987","ISO_8859-3:1988","ISO_8859-4:1988","ISO_8859-5:1988","ISO_8859-6:1987","ISO_8859-7:1987","ISO_8859-8:1988","ISO_8859-9:1989","ISO-8859-10","ISO_6937-2-add","JIS_X0201","JIS_Encoding","Shift_JIS","Extended_UNIX_Code_Packed_Format_for_Japanese","Extended_UNIX_Code_Fixed_Width_for_Japanese","BS_4730","SEN_850200_C","IT","ES","DIN_66003","NS_4551-1","NF_Z_62-010","ISO-10646-UTF-1","ISO_646.basic:1983","INVARIANT","ISO_646.irv:1983","NATS-SEFI","NATS-SEFI-ADD","NATS-DANO","NATS-DANO-ADD","SEN_850200_B","KS_C_5601-1987","ISO-2022-KR","EUC-KR","ISO-2022-JP","ISO-2022-JP-2","JIS_C6220-1969-jp","JIS_C6220-1969-ro","PT","greek7-old","latin-greek","NF_Z_62-010_(1973)","Latin-greek-1","ISO_5427","JIS_C6226-1978","BS_viewdata","INIS","INIS-8","INIS-cyrillic","ISO_5427:1981","ISO_5428:1980","GB_1988-80","GB_2312-80","NS_4551-2","videotex-suppl","PT2","ES2","MSZ_7795.3","JIS_C6226-1983","greek7","ASMO_449","iso-ir-90","JIS_C6229-1984-a","JIS_C6229-1984-b","JIS_C6229-1984-b-add","JIS_C6229-1984-hand","JIS_C6229-1984-hand-add","JIS_C6229-1984-kana","ISO_2033-1983","ANSI_X3.110-1983","T.61-7bit","T.61-8bit","ECMA-cyrillic","CSA_Z243.4-1985-1","CSA_Z243.4-1985-2","CSA_Z243.4-1985-gr","ISO_8859-6-E","ISO_8859-6-I","T.101-G2","ISO_8859-8-E","ISO_8859-8-I","CSN_369103","JUS_I.B1.002","IEC_P27-1","JUS_I.B1.003-serb","JUS_I.B1.003-mac","greek-ccitt","NC_NC00-10:81","ISO_6937-2-25","GOST_19768-74","ISO_8859-supp","ISO_10367-box","latin-lap","JIS_X0212-1990","DS_2089","us-dk","dk-us","KSC5636","UNICODE-1-1-UTF-7","ISO-2022-CN","ISO-2022-CN-EXT","UTF-8","ISO-8859-13","ISO-8859-14","ISO-8859-15","ISO-8859-16","GBK","GB18030","OSD_EBCDIC_DF04_15","OSD_EBCDIC_DF03_IRV","OSD_EBCDIC_DF04_1","ISO-11548-1","KZ-1048","ISO-10646-UCS-2","ISO-10646-UCS-4","ISO-10646-UCS-Basic","ISO-10646-Unicode-Latin1","ISO-10646-J-1","ISO-Unicode-IBM-1261","ISO-Unicode-IBM-1268","ISO-Unicode-IBM-1276","ISO-Unicode-IBM-1264","ISO-Unicode-IBM-1265","UNICODE-1-1","SCSU","UTF-7","UTF-16BE","UTF-16LE","UTF-16","CESU-8","UTF-32","UTF-32BE","UTF-32LE","BOCU-1","UTF-7-IMAP","ISO-8859-1-Windows-3.0-Latin-1","ISO-8859-1-Windows-3.1-Latin-1","ISO-8859-2-Windows-Latin-2","ISO-8859-9-Windows-Latin-5","hp-roman8","Adobe-Standard-Encoding","Ventura-US","Ventura-International","DEC-MCS","IBM850","PC8-Danish-Norwegian","IBM862","PC8-Turkish","IBM-Symbols","IBM-Thai","HP-Legal","HP-Pi-font","HP-Math8","Adobe-Symbol-Encoding","HP-DeskTop","Ventura-Math","Microsoft-Publishing","Windows-31J","GB2312","Big5","macintosh","IBM037","IBM038","IBM273","IBM274","IBM275","IBM277","IBM278","IBM280","IBM281","IBM284","IBM285","IBM290","IBM297","IBM420","IBM423","IBM424","IBM437","IBM500","IBM851","IBM852","IBM855","IBM857","IBM860","IBM861","IBM863","IBM864","IBM865","IBM868","IBM869","IBM870","IBM871","IBM880","IBM891","IBM903","IBM904","IBM905","IBM918","IBM1026","EBCDIC-AT-DE","EBCDIC-AT-DE-A","EBCDIC-CA-FR","EBCDIC-DK-NO","EBCDIC-DK-NO-A","EBCDIC-FI-SE","EBCDIC-FI-SE-A","EBCDIC-FR","EBCDIC-IT","EBCDIC-PT","EBCDIC-ES","EBCDIC-ES-A","EBCDIC-ES-S","EBCDIC-UK","EBCDIC-US","UNKNOWN-8BIT","MNEMONIC","MNEM","VISCII","VIQR","KOI8-R","HZ-GB-2312","IBM866","IBM775","KOI8-U","IBM00858","IBM00924","IBM01140","IBM01141","IBM01142","IBM01143","IBM01144","IBM01145","IBM01146","IBM01147","IBM01148","IBM01149","Big5-HKSCS","IBM1047","PTCP154","Amiga-1251","KOI7-switched","BRF","TSCII","CP51932","windows-874","windows-1250","windows-1251","windows-1252","windows-1253","windows-1254","windows-1255","windows-1256","windows-1257","windows-1258","TIS-620","CP50220"].some(function(e){return e===t});r("readerEncoding",e?t:"utf-8")}})}setupNode(){return this.export.button.addEventListener("click",()=>this.export.input.click()),this.export.input.addEventListener("input",e=>{var t=new FileReader;return Array.from(e.target.files).forEach(e=>{switch(this.fileReadMethod){case"readAsArrayBuffer":t.readAsArrayBuffer(e);break;case"readAsDataURL":t.readAsDataURL(e);break;case"readAsText":this.readerEncoding?t.readAsDataURL(e,this.readerEncoding):t.readAsDataURL(e);break;default:throw new Error("Wrong file read method")}return this.export.loadstart&&(t.onloadstart=e=>this.export.loadstart(e)),this.export.progress&&(t.onprogress=e=>this.export.progress(e)),this.export.abort&&(t.onabort=e=>this.export.abort(e)),this.export.loadend&&(t.onloadend=e=>this.export.loadend(e)),t.onerror=()=>this.failure("Upload error, client side"),t.onload=()=>(this.export.files.push({name:e.name,size:e.size,type:e.type,src:t.result}),this.success(this.export.files))})})}};