/*! lib - v1.2.1 - 2024-11-05 */
var UploadButton,Reg_=class{constructor(){this.locker={},this.map={},Object.defineProperty(this,"list",{get:function(){return this.export()}})}has(e){return e&&"string"==typeof e||e instanceof Symbol?e instanceof Symbol?!!this.locker[e]:"string"==typeof e?!!this.map[e]&&(e=this.map[e],!!this.locker[e]):void 0:null}save(e,t,r){return this.has(e)&&new Error("That id already taken"),t=r&&r.deep&&r.mime?new Blob([t],{type:r.mime}):t,"string"==typeof e?(r=Symbol(e),this.map[e]=r,this.locker[r]=t):e instanceof Symbol?this.locker[e]=t:void 0}fetch(e){var t,r,i;return this.has(e)?(i=new WeakMap,t={},"string"==typeof e?(r=this.map[e],i.set(t,this.locker[r])):e instanceof Symbol&&i.set(t,this.locker[e]),i.get(t)instanceof Blob?this.fetchDeep(t):i.get(t)):null}async fetchDeep(e){return tmp.get(e).text()}remove(e){var t,r,i,s,n;if(!this.has(e))return null;if("string"==typeof e)return i=this.map[e],delete this.locker[i],delete this.map[e];if(e instanceof Symbol){delete this.locker[e],r=[];for(n of Object.entries(this.map))[t,s]=n,r.push(s===e?delete this.map[t]:void 0);return r}}export(){var e,t,r,i;if(0===Object.keys(this.map).length&&0===Object.keys(this.locker).length)return null;(i=new WeakMap).set(t={},{});for(e of Object.keys(this.map)){if(r=this.map[e],!this.locker[r])throw new Error("Register's integrity is corrupt");Object.defineProperty(i.get(t),e,{value:this.locker[r]})}return i.get(t)}},rand=function(){return Math.random().toString(36).substring(2)},makeToken=function(){return rand()+rand()},isArray=function(e){return Array.isArray(e)},isObject=function(e){return e instanceof Object},till=function(t){if(t&&"number"==typeof t)return new Promise(function(e){return setTimeout(function(){return e()},t)})},findAttr=function(e,t,r={}){var i,s,n,a,o,h,d,l;if(!e||!t||"string"!=typeof e&&!isArray(e)||!t instanceof Element)throw new Error("incorrect function call");d=new WeakMap,a={},isArray(e)||(e=[e]),r.clean&&!isArray(r.clean)&&(r.clean=[r.clean]),d.set(a,{});for(s of e){d.get(a)[s]={};for(n of Array.from(t.querySelectorAll(`[${s}]`)))h=n.getAttribute(s),d.get(a)[s][h]=n}if(r.clean)for(l of Object.entries(d.get(a)))if([i,o]=l,!0===r.clean)for(n of Object.values(o))n.removeAttribute(i);else for(n of Object.values(o))r.clean.includes(i)&&n.removeAttribute(i);return 1===e.length?d.get(a)[e[0]]:d.get(a)},Modal=class{constructor(){this.register={reg:new Reg_,locker:{},history:[],has:function(e){return!!this.locker[e]||(this.history.includes(e),!1)},add:function(e,t){var r;if(this.has(e))throw new Error("Id already been used");return r=makeToken(),this.locker[e]=r,this.reg.save(r,t)},fetch:function(e){return e&&this.has(e)?(e=this.locker[e],this.reg.fetch(e)):null},remove:function(e){var t;return this.has(e)&&(t=this.locker[e],this.reg.remove(t),delete this.locker[e]),!0}}}add(e){var t,r,i,s;try{if(!e||!e instanceof Object)throw"Missing parameter";return[!e.name||"string"!=typeof e.name,!e.html||"string"!=typeof e.html,null!==e.handler&&!e.handler||!e.handler instanceof Object].some(function(e){if(!0===e)throw new Error("Corrupt parameter structure")}),{name:i,html:r,handler:t}=e,(s=document.createElement("template")).innerHTML=t&&t.beforeCreated?t.beforeCreated(r):r,t?this.register.add(i,{name:i,template:s,beforeRegister:t.beforeRegister,onshow:t.onshow,onhide:t.onhide,clean:t.clean}):this.register.add(i,{name:i,template:s})}catch(e){throw`Modal... prototype wasn't created
`+e}}prepare(e){var t,r;if(!e)throw"Missing prototype id";if(r=Symbol(e),t={},e=this.register.fetch(e))return Object.defineProperties(t,{name:{value:e.name,writable:!1,configurable:!1},node:{value:e.template.content.firstElementChild.cloneNode(!0),writable:!1,configurable:!1},sym:{value:r,writable:!1,configurable:!1},remove:{value:this.register.remove.bind(this.register),writable:!1,configurable:!1},onshow:{value:e.onshow,writable:!1,configurable:!1},onhide:{value:e.onhide,writable:!1,configurable:!1},clean:{value:e.clean,writable:!1,configurable:!1},isPreserved:{value:!0,writable:!0,configurable:!1},preserve:{set:function(e){return this.isPreserved=!!e}},show:{value:function(e){return(!e||!e instanceof Element)&&(e=document.body),this.container=e,this.onshow&&this.onshow(t),e.appendChild(this.node),this.onDisplay=!0},writable:!1,configurable:!1},hide:{value:async function(){this.onhide&&await this.onhide(t),this.container.removeChild(this.node),this.isPreserved?this.noDisplay=!1:(this.remove(this.sym),this.clean&&this.clean()),this.clean&&this.isPreserved},writable:!1,configurable:!1}}),e.beforeRegister&&e.beforeRegister(t),this.register.add(r,t),this.register.history.push(r),r;throw"No such prototype"}find(t){var e;try{if(null===(e=this.register.fetch(t)))throw"Instance does not exist";return e}catch(e){if(!((t=e)instanceof Error))throw t}}},ModalDefaults=class extends Modal{constructor(e={}){super(),this.args=e,this.localStorage={target:null,type:{items:[],has:function(e){return this.items.includes(null!=e&&e)},add:function(e){if(this.has(e))throw"Type exist";return this.items.push(e)},list:function(){return this.items}}},this.args.loadBootstrap&&this.loadBootstrap(),this.args.animation&&(this.animations=!0,Object.defineProperties(this,{animationDurration:{get:function(){return this.args.animation.durration||300}}}),this.loadAnimations()),this.args.target&&(this.localStorage.target=this.args.target),this.make()}throwMsg(e){var t,r,i;try{if(this.localStorage.type.has(e.type))return i=this.register.fetch(e.type),t=this.register.fetch(i),e.text&&(t.setText=e.text),t.show(null!=(r=this.localStorage.target)?r:document.body);throw`Modal default type: "${e.type}" unavailable`}catch(e){if(!((i=e)instanceof Error))throw i}}make(){var e=this.templates(),t=(this.animations,{beforeRegister:function(e){return Object.defineProperties(e,{refs:{value:findAttr("ref",e.node),writable:!1,configurable:!1,enumerable:!1},setText:{set:function(e){var t;return this.refs.title.innerHTML=null!=(t=e.title)?t:"",this.refs.msg.innerHTML=null!=(t=e.message)?t:"",this.refs.btn.textContent=null!=(t=e.button)?t:""}}}),e.refs.btn.addEventListener("click",function(){return e.hide()})},onshow:async e=>{this.animations&&(e.isPreserved&&e.node.classList.remove("hideDefaultModalBox"),await till(this.animationDurration),e.refs.btn.disabled=!1)},onhide:e=>{if(this.animations)return e.node.classList.add("hideDefaultModalBox"),e.refs.btn.disabled=!0,till(this.animationDurration)}});[{id:"error",name:"errorBox",html:e.errorBox,handler:{beforeRegister:function(e){return t.beforeRegister(e)},onshow:function(e){return t.onshow(e)},onhide:function(e){return t.onhide(e)}}},{id:"success",name:"successBox",html:e.successBox,handler:{beforeRegister:function(e){return t.beforeRegister(e)},onshow:function(e){return t.onshow(e)},onhide:function(e){return t.onhide(e)}}},{id:"info",name:"infoBox",html:e.infoBox,handler:{beforeRegister:function(e){return t.beforeRegister(e)},onshow:function(e){return t.onshow(e)},onhide:function(e){return t.onhide(e)}}},{id:"text",name:"textBox",html:e.textBox,handler:{beforeRegister:function(e){return t.beforeRegister(e)},onshow:function(e){return t.onshow(e)},onhide:function(e){return t.onhide(e)}}}].forEach(e=>{this.add(e),this.register.add(e.id,this.prepare(e.name)),this.localStorage.type.add(e.id)})}templates(){return{errorBox:`<div class="modalBox error">
  <div class="w-100 h-100 fixed-top container-fluid d-flex justify-content-center align-items-center">
    <div class="border border-2 rounded border-danger p-2" style="max-width:75%;min-width:400px">
      <!-- Title -->
      <div>
        <h2 class="text-danger" ref="title"></h2>
      </div>
      <!-- Message -->
      <div class="p-2">
        <p ref="msg"></p>
      </div>
      <!-- Button -->
      <div class="text-end">
        <button class="btn btn-danger" ref="btn"></button>
      </div>
    </div>
  </div>
</div>`,successBox:`<div class="modalBox success">
  <div class="w-100 h-100 fixed-top container-fluid d-flex justify-content-center align-items-center">
    <div class="border border-2 rounded border-success p-2" style="max-width:75%;min-width:400px">
      <!-- Title -->
      <div>
        <h2 class="text-success" ref="title"></h2>
      </div>
      <!-- Message -->
      <div class="p-2">
        <p ref="msg"></p>
      </div>
      <!-- Button -->
      <div class="text-end">
        <button class="btn btn-success" ref="btn"></button>
      </div>
    </div>
  </div>
</div>`,infoBox:`<div class="modalBox info">
  <div class="w-100 h-100 fixed-top container-fluid d-flex justify-content-center align-items-center">
    <div class="border border-2 rounded border-primary p-2" style="max-width:75%;min-width:400px">
      <!-- Title -->
      <div>
        <h2 class="text-primary" ref="title"></h2>
      </div>
      <!-- Message -->
      <div class="p-2">
        <p ref="msg"></p>
      </div>
      <!-- Button -->
      <div class="text-end">
        <button class="btn btn-primary" ref="btn"></button>
      </div>
    </div>
  </div>
</div>`,textBox:`<div class="modalBox text">
  <div class="w-100 h-100 fixed-top container-fluid d-flex justify-content-center align-items-center">
    <div class="border border-2 rounded border-secondary p-2" style="max-width:75%;min-width:400px">
      <!-- Title -->
      <div>
        <h2 class="text-secondary" ref="title"></h2>
      </div>
      <!-- Message -->
      <div class="p-2">
        <p ref="msg"></p>
      </div>
      <!-- Button -->
      <div class="text-end">
        <button class="btn btn-secondary" ref="btn"></button>
      </div>
    </div>
  </div>
</div>`}}loadAnimations(){var e,t=document.createElement("style");t.type="text/css",e=`@keyframes showDefaultModal {
  from {opacity: 0;}
  to {opacity: 1;}
}
@keyframes hideDefaultModal {
  from {opacity: 1;}
  to {opacity: 0;}
}
.modalBox {
  opacity: 0;
  animation-name: showDefaultModal;
  animation-duration: ${this.animationDurration}ms;
  animation-fill-mode: forwards;
}
.hideDefaultModalBox {
  opacity: 1;
  animation-name: hideDefaultModal;
}`,t.appendChild(document.createTextNode(e)),document.head.prepend(t)}loadBootstrap(){var e=document.createElement("link");e.href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css",e.integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH",e.rel="stylesheet",e.crossOrigin="anonymous",e.title="Bootstrap_css",document.head.prepend(e)}};class requestFunctions{constructor(){}validateArgs(){try{if(!this.args||!this.args.path||!this.args.method)throw"Missing property,\n either path or method, others are optional";if("GET"!==this.args.method&&"POST"!==this.args.method&&"PUT"!==this.args.method)throw"Unsupported method";if(this.args.headers&&"auto"!==this.args.headers){if(!Array.isArray(this.args.headers))throw"Wrong property instance. The 'headers' property, should be an array instance";if(0===this.args.headers.length)throw"If there is no headers in request, the 'headers' property should be defined as 'auto' ";let r;if(this.args.headers.forEach(function(e,t){r=!(!Array.isArray(e)||2!==e.length||"string"!=typeof e[0]||"string"!=typeof e[1])&&!1!==r}),!r)throw"Corrupted headers structure, all parameters should be an instance of an array, have two indexes, and they should be strings"}if(this.args.data){if(!Array.isArray(this.args.data))throw"Wrong property instance. The 'data' property, should be an array instance";if(0===this.args.data.length)throw"If there is no parameters in request data, the 'data' property should be defined as null";let r;if(this.args.data.forEach(function(e,t){r=e instanceof Object&&"name"in e&&"value"in e&&"string"==typeof e.name&&!1!==r}),!r)throw"Corrupted data structure, all parameters should be an instance of an object, have name and value properties, name schoud be a string"}return!0}catch(e){throw e instanceof Error?"Syntax error":`Provided arguments are invalid
\r`+e}}prepareRequest(){try{if(this.path=this.args.path,this.method=this.args.method,this.headers="auto"===this.args.headers?null:this.args.headers,this.args.data)if("GET"===this.args.method){let t;t="?time="+encodeURIComponent((new Date).toString()),this.args.data.forEach(function(e){t+=`&${e.name}=`+encodeURIComponent(e.value)}),this.path=this.path+t}else if("POST"===this.args.method){let t=new FormData;t.append("time",(new Date).toString()),this.args.data.forEach(function(e){t.append(e.name,e.value)}),this.data=t}else"PUT"===this.args.method&&(this.data=this.args.data)}catch(e){throw e instanceof Error?"Syntax error":"While preparing request\n"+e}}}class XHRRequest extends requestFunctions{constructor(e){return super(),this.args=e,this.init()}init(){try{return this.validateArgs(),this.prepareRequest(),this.call()}catch(e){return!1}}call(){return new Promise((t,r)=>{let i=new XMLHttpRequest;this.args.progress&&i.upload.addEventListener("progress",this.args.progress),i.addEventListener("error",e=>{this.args.error&&this.args.error(e),r(e)}),i.addEventListener("abort",e=>{this.args.abort&&this.args.abort(e),r(e)}),i.addEventListener("load",e=>{this.args.load&&this.args.load(e),t(JSON.parse(e.target.response))}),i.open(this.method,this.path,!0),this.headers&&this.headers.forEach(function(e){i.setRequestHeader(e[0],e[1])}),i.send(this.data||null)})}}UploadButton=class{constructor(){return this.prepareNode(),this.export}prepareNode(){var r,e,t=document.createElement("template");return t.innerHTML=`<div role="button">
  <button ref="btn" onclick="this.nextElementSibling.click()" >Browse</button>
  <input  ref="inpt" type="file" hidden />
</div>`,e=this.setup.bind(this),r=(e,t)=>{if("fileReadMethod"===e&&(this.fileReadMethod=t),"readerEncoding"===e)return this.readerEncoding=t},t=t.content.firstElementChild,Object.defineProperty(this,"export",{value:{wrapper:t,button:t.querySelector("[ref=btn]"),input:t.querySelector("[ref=inpt]"),files:[],swapWith:function(e){if(!e||!e instanceof Element||"button"!==e.localName)throw new Error("The button wasn't swapped");return e.addEventListener("click",()=>this.input.click()),e.parentNode.replaceChild(this.wrapper,e),this.wrapper.replaceChild(e,this.button),this.button=e},setup:function(){return e()}}}),Object.defineProperty(this.export,"returnFormat",{set(t){var e=["readAsArrayBuffer","readAsDataURL","readAsText"].some(function(e){return e===t});r("fileReadMethod",e?t:"readAsDataURL")}}),Object.defineProperty(this.export,"encodingFormat",{set(e){r("readerEncoding",e)}}),Object.defineProperty(this.export,"allowMultiple",{set(e){e?this.input.setAttribute("multiple","multiple"):this.input.removeAttribute("multiple","multiple")}})}setup(){return this.export.input.addEventListener("input",e=>Array.from(e.target.files).forEach(t=>{var r=new FileReader;switch(this.fileReadMethod){case"readAsArrayBuffer":r.readAsArrayBuffer(t);break;case"readAsDataURL":r.readAsDataURL(t);break;case"readAsText":this.readerEncoding?r.readAsDataURL(t,this.readerEncoding):r.readAsDataURL(t,"utf-8");break;default:throw new Error("Wrong read method")}return this.export.loadstart&&(r.onloadstart=e=>this.export.loadstart(e)),this.export.progress&&(r.onprogress=e=>this.export.progress(e)),this.export.abort&&(r.onabort=e=>this.export.abort(e)),this.export.loadend&&(r.onloadend=e=>this.export.loadend(e)),this.export.onerror&&(r.onerror=e=>this.export.onerror(e)),r.onload=e=>this.export.onload({name:t.name,size:t.size,type:t.type,src:r.result})}))}};